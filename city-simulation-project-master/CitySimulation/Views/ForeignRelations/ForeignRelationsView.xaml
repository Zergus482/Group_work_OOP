<UserControl x:Class="CitySimulation.Views.ForeignRelations.ForeignRelationsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             Height="Auto" Width="Auto">

    <UserControl.Resources>
        <x:Array x:Key="ImmigrationReasons" Type="sys:String">
            <sys:String>Работа</sys:String>
            <sys:String>Учеба</sys:String>
            <sys:String>Беженец</sys:String>
            <sys:String>Семья</sys:String>
            <sys:String>Бизнес</sys:String>
        </x:Array>

        <x:Array x:Key="ResourceTypes" Type="sys:String">
            <sys:String>Нефть</sys:String>
            <sys:String>Газ</sys:String>
            <sys:String>Железо</sys:String>
            <sys:String>Медь</sys:String>
            <sys:String>Дерево</sys:String>
            <sys:String>Электроэнергия</sys:String>
            <sys:String>Промтовары</sys:String>
        </x:Array>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <Grid MinHeight="600" MinWidth="1000">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="Внешние связи" FontSize="20" FontWeight="Bold" Margin="10"/>

            <TabControl Grid.Row="1">
                <!-- Вкладка стран -->
                <TabItem Header="Страны">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Список стран -->
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Список стран:" FontWeight="Bold" Margin="0,0,0,10"/>
                                <ListBox ItemsSource="{Binding ForeignRelationsVM.Countries}" 
                                         SelectedItem="{Binding ForeignRelationsVM.SelectedCountry}" 
                                         Height="200" Margin="0,0,0,10">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Margin="5">
                                                <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding RelationsLevel, StringFormat='Отношения: {0}'}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                                <Button Content="Удалить страну" 
                                        Command="{Binding ForeignRelationsVM.DeleteCountryCommand}"
                                        Width="120" Height="30"/>
                            </StackPanel>

                            <!-- Управление странами -->
                            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="Управление странами:" FontWeight="Bold" Margin="0,0,0,10"/>

                                    <!-- Добавление новой страны -->
                                    <GroupBox Header="Добавить новую страну" Margin="0,0,0,10">
                                        <StackPanel>
                                            <TextBlock Text="Название страны:" Margin="0,0,0,2"/>
                                            <TextBox Text="{Binding ForeignRelationsVM.NewCountryName}" 
                                                     Height="25" Margin="0,0,0,10"/>
                                            <Button Content="Добавить страну" 
                                                    Command="{Binding ForeignRelationsVM.AddCountryCommand}"
                                                    Width="120" Height="30"/>
                                        </StackPanel>
                                    </GroupBox>

                                    <!-- Изменение отношений -->
                                    <GroupBox Header="Изменение отношений" Margin="0,0,0,10">
                                        <StackPanel>
                                            <TextBlock Text="Выбранная страна:" FontWeight="Bold"/>
                                            <TextBlock Text="{Binding ForeignRelationsVM.SelectedCountry.Name}" FontSize="14" Margin="0,0,0,5"/>
                                            <TextBlock Text="{Binding ForeignRelationsVM.SelectedCountry.RelationsLevel, StringFormat='Текущий уровень: {0}'}"/>

                                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                <TextBlock Text="Изменение:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBox Text="{Binding ForeignRelationsVM.RelationChange}" 
                                                         Width="50" Margin="0,0,5,0"
                                                         TextAlignment="Center"/>
                                                <Button Content="Применить" 
                                                        Command="{Binding ForeignRelationsVM.ChangeRelationCommand}"
                                                        Width="80" Height="30"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Вкладка иммигрантов -->
                <TabItem Header="Иммигранты">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Список иммигрантов -->
                            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="Список иммигрантов:" FontWeight="Bold" Margin="0,0,0,10"/>
                                    <ListBox ItemsSource="{Binding ForeignRelationsVM.Immigrants}" 
                                             SelectedItem="{Binding ForeignRelationsVM.SelectedImmigrant}"
                                             Height="200" Margin="0,0,0,10">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="5">
                                                    <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding CountryOfOrigin.Name, StringFormat='Из страны: {0}'}"/>
                                                    <TextBlock Text="{Binding Reason, StringFormat='Причина: {0}'}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>

                                    <Button Content="Удалить иммигранта" 
                                            Command="{Binding ForeignRelationsVM.DeleteImmigrantCommand}"
                                            Width="120" Height="30"/>
                                </StackPanel>
                            </ScrollViewer>

                            <!-- Форма добавления иммигранта -->
                            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="Добавить нового иммигранта:" FontWeight="Bold" Margin="0,0,0,10"/>

                                    <StackPanel>
                                        <TextBlock Text="ФИО:" Margin="0,0,0,2"/>
                                        <TextBox Text="{Binding ForeignRelationsVM.NewImmigrantName}" 
                                                 Height="25" Margin="0,0,0,10"/>

                                        <TextBlock Text="Страна происхождения:" Margin="0,0,0,2"/>
                                        <ComboBox ItemsSource="{Binding ForeignRelationsVM.Countries}"
                                                  SelectedItem="{Binding ForeignRelationsVM.NewImmigrantCountry}"
                                                  DisplayMemberPath="Name"
                                                  Height="25" Margin="0,0,0,10"/>

                                        <TextBlock Text="Причина иммиграции:" Margin="0,0,0,2"/>
                                        <ComboBox ItemsSource="{StaticResource ImmigrationReasons}"
                                                  SelectedValue="{Binding ForeignRelationsVM.NewImmigrantReason}"
                                                  Height="25" Margin="0,0,0,10"/>

                                        <Button Content="Добавить иммигранта" 
                                                Command="{Binding ForeignRelationsVM.AddImmigrantCommand}"
                                                Width="140" Height="30"/>
                                    </StackPanel>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Вкладка торговых сделок -->
                <TabItem Header="Торговые сделки">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Список сделок -->
                            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="Активные сделки:" FontWeight="Bold" Margin="0,0,0,10"/>
                                    <ListBox ItemsSource="{Binding ForeignRelationsVM.TradeDeals}" 
                                             Height="200" Margin="0,0,0,10">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="5">
                                                    <TextBlock Text="{Binding Resource, StringFormat='Ресурс: {0}'}" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding Quantity, StringFormat='Количество: {0}'}"/>
                                                    <TextBlock Text="{Binding PricePerUnit, StringFormat='Цена: {0:C}'}"/>
                                                    <TextBlock Text="{Binding TotalCost, StringFormat='Общая стоимость: {0:C}'}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </StackPanel>
                            </ScrollViewer>

                            <!-- Форма добавления сделки -->
                            <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <TextBlock Text="Добавить торговую сделку:" FontWeight="Bold" Margin="0,0,0,10"/>

                                    <StackPanel>
                                        <TextBlock Text="Ресурс:" Margin="0,0,0,2"/>
                                        <ComboBox ItemsSource="{StaticResource ResourceTypes}"
                                                  SelectedValue="{Binding ForeignRelationsVM.NewTradeResource}"
                                                  Height="25" Margin="0,0,0,10"/>

                                        <TextBlock Text="Количество:" Margin="0,0,0,2"/>
                                        <TextBox Text="{Binding ForeignRelationsVM.NewTradeQuantity}" 
                                                 Height="25" Margin="0,0,0,10"/>

                                        <TextBlock Text="Цена за единицу:" Margin="0,0,0,2"/>
                                        <TextBox Text="{Binding ForeignRelationsVM.NewTradePrice}" 
                                                 Height="25" Margin="0,0,0,10"/>

                                        <Button Content="Добавить сделку" 
                                                Command="{Binding ForeignRelationsVM.AddTradeDealCommand}"
                                                Width="120" Height="30"/>
                                    </StackPanel>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
            </TabControl>

            <StatusBar Grid.Row="2" Background="LightGray">
                <TextBlock Text="{Binding ForeignRelationsVM.StatusMessage}" FontWeight="Bold"/>
            </StatusBar>
        </Grid>
    </ScrollViewer>
</UserControl>